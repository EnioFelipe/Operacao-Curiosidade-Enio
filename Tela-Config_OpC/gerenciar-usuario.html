<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../global-style.css">
    <link rel="stylesheet" href="../modal-style.css">
    <link rel="stylesheet" href="gerenciar-usuario-style.css">
    <title>Gerenciar Usuários</title>
</head>
<body>
    <div class="filtro">
        <div class="label-input">
            <label for="tipo-item">Status</label>
            <select name="tipo-item" id="tipo-item">
                <option value="" disabled selected>Selecione</option>
                <option value="ativo">Ativo</option>
                <option value="inativo">Inativo</option>
            </select>
        </div>
        <div class="label-input">
            <label for="tipo-local">Tipo</label>
            <select name="tipo-local" id="tipo-local">
                <option value="" disabled selected>Selecione</option>
                <option value="administrador">Administrador</option>
                <option value="operador">Operador</option>
            </select>
        </div>
        <div class="label-input">
            <label for="tipo-usuario">Nome ou Código</label>
            <input type="search" name="tipo-usuario" id="tipo-usuario" placeholder="Pesquisar">
        </div>
        <div class="label-input">
            <label for="tipo-periodo-inicio">Data Início</label>
            <input type="date" name="tipo-periodo-inicio" id="tipo-periodo-inicio">
        </div>
        <div class="label-input">
            <label for="tipo-periodo-fim">Data Fim</label>
            <input type="date" name="tipo-periodo-fim" id="tipo-periodo-fim">
        </div>
        <div class="form-actions">
            <input id="limpar-filtros" class="btn-auditoria" type="reset" value="Limpar">
            <button id="btn-criar-usuario" class="btn-auditoria">Criar Usuário</button>        
        </div>
    </div>
    <div class="index-corpo">
        <p><input type="checkbox">Código</p>
        <p>Nome</p>
        <p>e-mail</p>
        <p>Data de criação</p>
        <p>Status</p>
    </div>
    <div id="relatorio-usuarios" class="corpo-auditoria">
        <!-- Usuários serão exibidos aqui -->
    </div>
    <div class="rodape-usuario">
        <div class="pagination-info">
            <label for="itens-por-pg">Itens por página</label>
            <input type="number" name="itens-por-pg" id="itens-por-pg" value="5">
        </div>
        <div id="pagination-controls" class="pagination-controls">
            <!-- Controles de paginação serão exibidos aqui -->
        </div>
    </div>

    <div id="modal-criar-usuario" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <iframe id="iframe-usuario" src=""></iframe>
        </div>
    </div>

    <script src="../Integracao-API/exibicao-usuario-relatorio-API.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {

            const itensPorPgInput = document.getElementById('itens-por-pg');
            itensPorPgInput.addEventListener('change', function() {
                pageSize = parseInt(itensPorPgInput.value, 10);
                currentPage = 1;
                applyFilters();
            });

            // Obter o modal
            var modal = document.getElementById("modal-criar-usuario");

            // Obter o botão que abre o modal
            var btn = document.getElementById("btn-criar-usuario");

            // Obter o elemento <span> que fecha o modal
            var span = document.getElementsByClassName("close")[0];

            // Quando o usuário clicar no botão, abre o modal 
            btn.onclick = function() {
                exibirIframe('criar');
            }

            // Quando o usuário clicar em <span> (x), fecha o modal
            span.onclick = function() {
                modal.style.display = "none";
            }

            // Quando o usuário clicar em qualquer lugar fora do modal, fecha o modal
            window.onclick = function(event) {
                if (event.target == modal) {
                    modal.style.display = "none";
                }
            }
        });

        // Função para exibir o iframe com diferentes ações
        function exibirIframe(acao, usuarioId = '') {
            const iframe = document.getElementById('iframe-usuario');
            let src = '';

            switch (acao) {
                case 'criar':
                    src = '../Tela-complementos_OpC/cadastro-usuario.html';
                    break;
                case 'editar':
                    src = `../Tela-complementos_OpC/editar-usuario.html?usuarioId=${usuarioId}`;
                    break;
                case 'remover':
                    src = `../Tela-complementos_OpC/remover-usuario-sistema.html?usuarioId=${usuarioId}`;
                    break;
            }

            iframe.src = src;
            document.getElementById('modal-criar-usuario').style.display = 'block';
        }
    </script>

</body>
</html>